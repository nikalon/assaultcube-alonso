name: assaultcube
version: '1.2.0.2'
summary: Arcade first-person shooter
description: |
  AssaultCube is a fast-paced and arcade first-person shooter in 3D targeted at
  low spec computers and low latency connections.

grade: devel
confinement: devmode

apps:
  assaultcube:
    command: bin/client-launcher.sh
  server:
    command: bin/server-launcher.sh

parts:
  assaultcube:
    plugin: make
    make-parameters: ["ACDEBUG=yes"]
    source: https://github.com/assaultcube/AC.git
    source-branch: next
    source-subdir: source/src
    install: |
      install -d ${SNAPCRAFT_PART_INSTALL}/bin
      cp -rp * ${SNAPCRAFT_PART_INSTALL}/bin
    stage:
      - -bin/bin_win32/
      - -bin/source/
      - -bin/*.bat
      - -bin/*.sh
    build-packages:
      - build-essential
      - clang
      - libsdl1.2debian
      - libsdl1.2-dev
      - libsdl-image1.2
      - libsdl-image1.2-dev
      - libopenal1
      - libopenal-dev
      - libvorbis-dev

  client-launcher:
    plugin: dump
    after: [assaultcube]
    source: .
    stage:
      - bin/client-launcher.sh
    organize:
      client-launcher.sh: bin/client-launcher.sh

  server-launcher:
    plugin: dump
    after: [assaultcube]
    source: .
    stage:
      - bin/server-launcher.sh
    organize:
      server-launcher.sh: bin/server-launcher.sh

  libs:
    plugin: nil
    after: [assaultcube]
    stage-packages:
      - libgcc1
      - libgl1-mesa-glx
      - libopenal1
      - libsdl-image1.2
      - libsdl1.2debian
      - libvorbisfile3
      - libx11-6
      - zlib1g

